using Microsoft.Playwright;
using System;
using System.Threading.Tasks;

namespace PlaywrightDemo.PageOjectModel
{
    public class AssetCreate
    {
        private readonly IPage _page;

        public AssetCreate(IPage page)
        {
            _page = page;
        }

        public async Task CreateMacbookAssetAsync()
        {
            await _page.GotoAsync("https://demo.snipeitapp.com/hardware/create");

            string assetName = $"MacBook Pro 13 - {Guid.NewGuid()}";
            await _page.FillAsync("#name", assetName);

            await _page.ClickAsync("#model_id");
            await _page.TypeAsync("#model_id", "MacBook Pro 13");
            await _page.Keyboard.PressAsync("Enter");

            await _page.SelectOptionAsync("#status_id", new SelectOptionValue
            {
                Label = "Ready to Deploy"
            });

            await _page.CheckAsync("#checkout_to_user");

            await _page.ClickAsync("#assigned_to");
            await _page.Keyboard.PressAsync("ArrowDown");
            await _page.Keyboard.PressAsync("Enter");

            await _page.ClickAsync("button[type='submit']");

            await _page.WaitForSelectorAsync("text=Success");
        }
    }
}
